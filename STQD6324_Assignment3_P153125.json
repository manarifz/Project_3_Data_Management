{"paragraphs":[{"text":"%md\n# This Assignment 3 Data Management was performed to discover the `u.user` file from the Movielens 100k Dataset.","user":"anonymous","dateUpdated":"2025-07-22T05:57:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>This Assignment 3 Data Management was performed to discover the <code>u.user</code> file from the Movielens 100k Dataset.</h1>\n"}]},"apps":[],"jobName":"paragraph_1753153748936_274999085","id":"20250722-030908_1164339571","dateCreated":"2025-07-22T03:09:08+0000","dateStarted":"2025-07-22T05:57:28+0000","dateFinished":"2025-07-22T05:57:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9338"},{"text":"%md\n# Step (1): Retreived the file to a local temp folder ","user":"anonymous","dateUpdated":"2025-07-22T05:57:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (1): Retreived the file to a local temp folder</h1>\n"}]},"apps":[],"jobName":"paragraph_1753155192242_816007469","id":"20250722-033312_321749397","dateCreated":"2025-07-22T03:33:12+0000","dateStarted":"2025-07-22T05:57:48+0000","dateFinished":"2025-07-22T05:57:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9339"},{"text":"%md\n## (i) Retrieve u.user file","user":"anonymous","dateUpdated":"2025-07-22T05:58:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163880364_-1601774951","id":"20250722-055800_1643489012","dateCreated":"2025-07-22T05:58:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11881","dateFinished":"2025-07-22T05:58:51+0000","dateStarted":"2025-07-22T05:58:51+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>(i) Retrieve u.user file</h2>\n"}]}},{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.user -O /tmp/u.user\n\necho \"Downloaded u.user file from ml-100k dataset!\"","user":"anonymous","dateUpdated":"2025-07-22T05:13:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-07-22 05:13:22--  http://media.sundog-soft.com/hadoop/ml-100k/u.user\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.113.227, 52.216.52.113, 3.5.9.216, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.113.227|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K) [text/plain]\nSaving to: ‘/tmp/u.user’\n\n     0K .......... .......... ..                              100% 95.9K=0.2s\n\n2025-07-22 05:13:23 (95.9 KB/s) - ‘/tmp/u.user’ saved [22628/22628]\n\nDownloaded u.user file from ml-100k dataset!\n"}]},"apps":[],"jobName":"paragraph_1753155259060_1145260582","id":"20250722-033419_316253451","dateCreated":"2025-07-22T03:34:19+0000","dateStarted":"2025-07-22T05:13:22+0000","dateFinished":"2025-07-22T05:13:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9340"},{"text":"%md\n## (ii) Retrieve u.data file\n","user":"anonymous","dateUpdated":"2025-07-22T05:59:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163938595_2132890677","id":"20250722-055858_1050808293","dateCreated":"2025-07-22T05:58:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11965","dateFinished":"2025-07-22T05:59:16+0000","dateStarted":"2025-07-22T05:59:16+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>(ii) Retrieve u.data file</h2>\n"}]}},{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\n\necho \"Downloaded u.data file from ml-100k dataset!\"","user":"anonymous","dateUpdated":"2025-07-22T05:13:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-07-22 05:13:26--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.37.9, 3.5.29.150, 54.231.223.57, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.37.9|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2% 98.0K 20s\n    50K .......... .......... .......... .......... ..........  4% 1.08M 11s\n   100K .......... .......... .......... .......... ..........  7%  234K 10s\n   150K .......... .......... .......... .......... ..........  9% 12.6M 7s\n   200K .......... .......... .......... .......... .......... 12%  200K 7s\n   250K .......... .......... .......... .......... .......... 14% 11.5M 6s\n   300K .......... .......... .......... .......... .......... 17% 11.3M 5s\n   350K .......... .......... .......... .......... .......... 19%  174K 5s\n   400K .......... .......... .......... .......... .......... 22% 10.9M 5s\n   450K .......... .......... .......... .......... .......... 24% 25.8M 4s\n   500K .......... .......... .......... .......... .......... 27% 64.9M 4s\n   550K .......... .......... .......... .......... .......... 29% 49.5M 3s\n   600K .......... .......... .......... .......... .......... 32%  203K 3s\n   650K .......... .......... .......... .......... .......... 34% 8.52M 3s\n   700K .......... .......... .......... .......... .......... 36% 11.3M 3s\n   750K .......... .......... .......... .......... .......... 39%  104K 3s\n   800K .......... .......... .......... .......... .......... 41% 1.78M 3s\n   850K .......... .......... .......... .......... .......... 44% 14.2M 3s\n   900K .......... .......... .......... .......... .......... 46% 29.4M 2s\n   950K .......... .......... .......... .......... .......... 49% 31.9M 2s\n  1000K .......... .......... .......... .......... .......... 51%  137M 2s\n  1050K .......... .......... .......... .......... .......... 54% 27.4M 2s\n  1100K .......... .......... .......... .......... .......... 56% 7.94M 2s\n  1150K .......... .......... .......... .......... .......... 59%  211K 2s\n  1200K .......... .......... .......... .......... .......... 61% 6.48M 1s\n  1250K .......... .......... .......... .......... .......... 64% 11.6M 1s\n  1300K .......... .......... .......... .......... .......... 66% 8.74M 1s\n  1350K .......... .......... .......... .......... .......... 68%  211K 1s\n  1400K .......... .......... .......... .......... .......... 71% 5.71M 1s\n  1450K .......... .......... .......... .......... .......... 73% 11.1M 1s\n  1500K .......... .......... .......... .......... .......... 76% 11.3M 1s\n  1550K .......... .......... .......... .......... .......... 78%  211K 1s\n  1600K .......... .......... .......... .......... .......... 81% 5.78M 1s\n  1650K .......... .......... .......... .......... .......... 83% 10.2M 1s\n  1700K .......... .......... .......... .......... .......... 86% 11.1M 0s\n  1750K .......... .......... .......... .......... .......... 88%  237K 0s\n  1800K .......... .......... .......... .......... .......... 91% 1.58M 0s\n  1850K .......... .......... .......... .......... .......... 93% 6.46M 0s\n  1900K .......... .......... .......... .......... .......... 96% 11.9M 0s\n  1950K .......... .......... .......... .......... .......... 98% 11.1M 0s\n  2000K .......... .......... ..........                      100%  131K=3.4s\n\n2025-07-22 05:13:31 (605 KB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\nDownloaded u.data file from ml-100k dataset!\n"}]},"apps":[],"jobName":"paragraph_1753155288889_1508878941","id":"20250722-033448_1524284400","dateCreated":"2025-07-22T03:34:48+0000","dateStarted":"2025-07-22T05:13:26+0000","dateFinished":"2025-07-22T05:13:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9341"},{"text":"%md\n## (iii) Retrieve u.item file","user":"anonymous","dateUpdated":"2025-07-22T05:59:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163960435_-550501394","id":"20250722-055920_1171919801","dateCreated":"2025-07-22T05:59:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12080","dateFinished":"2025-07-22T05:59:48+0000","dateStarted":"2025-07-22T05:59:48+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>(iii) Retrieve u.item file</h2>\n"}]}},{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\necho \"Downloaded u.item file ml-100k dataset!\"","user":"anonymous","dateUpdated":"2025-07-22T05:13:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-07-22 05:13:33--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.217.172.161, 3.5.24.26, 3.5.2.79, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.217.172.161|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  102K 2s\n    50K .......... .......... .......... .......... .......... 43% 1006K 1s\n   100K .......... .......... .......... .......... .......... 64%  251K 0s\n   150K .......... .......... .......... .......... .......... 86% 9.79M 0s\n   200K .......... .......... ..........                      100%  130K=1.0s\n\n2025-07-22 05:13:35 (235 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\nDownloaded u.item file ml-100k dataset!\n"}]},"apps":[],"jobName":"paragraph_1753155294960_1793608451","id":"20250722-033454_1754922063","dateCreated":"2025-07-22T03:34:54+0000","dateStarted":"2025-07-22T05:13:33+0000","dateFinished":"2025-07-22T05:13:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9342"},{"text":"%md\n# Step (2): Remove directory if already available","user":"anonymous","dateUpdated":"2025-07-22T06:00:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (2): Remove directory if already available</h1>\n"}]},"apps":[],"jobName":"paragraph_1753155434869_-897558508","id":"20250722-033714_1677814829","dateCreated":"2025-07-22T03:37:14+0000","dateStarted":"2025-07-22T06:00:13+0000","dateFinished":"2025-07-22T06:00:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9343"},{"text":"%sh\nhadoop fs -rm -r -f /tmp/ml-100k","user":"anonymous","dateUpdated":"2025-07-22T05:13:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"25/07/22 05:13:55 INFO fs.TrashPolicyDefault: Moved: 'hdfs://sandbox-hdp.hortonworks.com:8020/tmp/ml-100k' to trash at: hdfs://sandbox-hdp.hortonworks.com:8020/user/zeppelin/.Trash/Current/tmp/ml-100k1753161235610\n"}]},"apps":[],"jobName":"paragraph_1753155491345_260443737","id":"20250722-033811_1904981515","dateCreated":"2025-07-22T03:38:11+0000","dateStarted":"2025-07-22T05:13:40+0000","dateFinished":"2025-07-22T05:13:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9344"},{"text":"%md\n\n# Step (3): Create new directory","user":"anonymous","dateUpdated":"2025-07-22T06:00:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (3): Create new directory</h1>\n"}]},"apps":[],"jobName":"paragraph_1753155641793_746395277","id":"20250722-034041_1507986016","dateCreated":"2025-07-22T03:40:41+0000","dateStarted":"2025-07-22T06:00:35+0000","dateFinished":"2025-07-22T06:00:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9345"},{"text":"%sh\nhadoop fs -mkdir /tmp/ml-100k/\n","user":"anonymous","dateUpdated":"2025-07-22T05:14:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1753155631010_424178202","id":"20250722-034031_999225843","dateCreated":"2025-07-22T03:40:31+0000","dateStarted":"2025-07-22T05:14:10+0000","dateFinished":"2025-07-22T05:14:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9346"},{"text":"%md\n\n# Step (4): Allocate the files from local to the HDFS","user":"anonymous","dateUpdated":"2025-07-22T06:01:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (4): Allocate the files from local to the HDFS</h1>\n"}]},"apps":[],"jobName":"paragraph_1753155510088_-2005126353","id":"20250722-033830_1241496799","dateCreated":"2025-07-22T03:38:30+0000","dateStarted":"2025-07-22T06:01:30+0000","dateFinished":"2025-07-22T06:01:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9347"},{"text":"%sh\nhadoop fs -put /tmp/u.user /tmp/ml-100k/\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-07-22T05:14:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1753155540400_2047110359","id":"20250722-033900_1228501453","dateCreated":"2025-07-22T03:39:00+0000","dateStarted":"2025-07-22T05:14:17+0000","dateFinished":"2025-07-22T05:14:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9348"},{"text":"%md\n# Step (5): First create database movielens22072025 in Cassandra\n```{shell}\nCREATE KEYSPACE movielens22072025 WITH replication = {‘class’: ‘SimpleStrategy’, \n‘replication_factor’:’1’} AND durable_writes = true;\n```","user":"anonymous","dateUpdated":"2025-07-22T06:05:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163684314_1293785619","id":"20250722-055444_2022688257","dateCreated":"2025-07-22T05:54:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11610","dateFinished":"2025-07-22T06:05:43+0000","dateStarted":"2025-07-22T06:05:43+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (5): First create database movielens22072025 in Cassandra</h1>\n<pre><code class=\"{shell}\">CREATE KEYSPACE movielens22072025 WITH replication = {‘class’: ‘SimpleStrategy’, \n‘replication_factor’:’1’} AND durable_writes = true;\n</code></pre>\n"}]}},{"text":"%md\n\n# Step (6): Make sure tables have been created in Cassandra\n\n```{shell}\nCREATE TABLE ratings (\n  user_id int,\n  movieid int,\n  rating int,\n  PRIMARY KEY (user_id, movieid)\n);\n\nCREATE TABLE titles (\n  movieid int PRIMARY KEY,\n  title text,\n  unknown int,\n  action int,\n  adventure int,\n  animation int,\n  children int,\n  comedy int,\n  crime int,\n  documentary int,\n  drama int,\n  fantasy int,\n  filmnoir int,\n  horror int,\n  musical int,\n  mystery int,\n  romance int,\n  scifi int,\n  thriller int,\n  war int,\n  western int\n);\n\nCREATE TABLE users (\n  user_id int, \n  age int, \n  gender text, \n  occupation text, \n  zip text,\nPRIMARY KEY (user_id)\n);\n```\n","user":"anonymous","dateUpdated":"2025-07-22T06:04:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (6): Make sure tables have been created in Cassandra</h1>\n<pre><code class=\"{shell}\">CREATE TABLE ratings (\n  user_id int,\n  movieid int,\n  rating int,\n  PRIMARY KEY (user_id, movieid)\n);\n\nCREATE TABLE titles (\n  movieid int PRIMARY KEY,\n  title text,\n  unknown int,\n  action int,\n  adventure int,\n  animation int,\n  children int,\n  comedy int,\n  crime int,\n  documentary int,\n  drama int,\n  fantasy int,\n  filmnoir int,\n  horror int,\n  musical int,\n  mystery int,\n  romance int,\n  scifi int,\n  thriller int,\n  war int,\n  western int\n);\n\nCREATE TABLE users (\n  user_id int, \n  age int, \n  gender text, \n  occupation text, \n  zip text,\nPRIMARY KEY (user_id)\n);\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1753155568560_-164179487","id":"20250722-033928_670337866","dateCreated":"2025-07-22T03:39:28+0000","dateStarted":"2025-07-22T06:04:57+0000","dateFinished":"2025-07-22T06:04:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9349"},{"text":"%md\n# Step (7): Create RDD for Spark Analysis","user":"anonymous","dateUpdated":"2025-07-22T06:06:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step (7): Create RDD for Spark Analysis</h1>\n"}]},"apps":[],"jobName":"paragraph_1753156472462_932396441","id":"20250722-035432_9248835","dateCreated":"2025-07-22T03:54:32+0000","dateStarted":"2025-07-22T06:06:07+0000","dateFinished":"2025-07-22T06:06:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9350"},{"text":"%md\n### (i) Create Users RDD and DataFrame","user":"anonymous","dateUpdated":"2025-07-22T06:06:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>(i) Create Users RDD and DataFrame</h3>\n"}]},"apps":[],"jobName":"paragraph_1753156514287_-1611701204","id":"20250722-035514_516911453","dateCreated":"2025-07-22T03:55:14+0000","dateStarted":"2025-07-22T06:06:21+0000","dateFinished":"2025-07-22T06:06:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9351"},{"text":"print(spark.version)\n","user":"anonymous","dateUpdated":"2025-07-22T05:34:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2.3.0.2.6.5.0-292"}]},"apps":[],"jobName":"paragraph_1753161911509_313533554","id":"20250722-052511_310858731","dateCreated":"2025-07-22T05:25:11+0000","dateStarted":"2025-07-22T05:34:37+0000","dateFinished":"2025-07-22T05:34:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9352"},{"text":"%pyspark\r\n\r\nfrom pyspark.sql import Row\r\nfrom pyspark.sql import functions as F\r\n\r\n# ParseInput function\r\ndef parseInput(line):\r\n    fields = line.split('|')\r\n    return Row(user_id=int(fields[0]), age=int(fields[1]), gender=fields[2], occupation=fields[3], zip=fields[4])\r\n\r\n# Load raw user data from HDFS\r\nlines = spark.sparkContext.textFile(\"hdfs:///tmp/ml-100k/u.user\")\r\n\r\n# Apply transformation\r\nusers = lines.map(parseInput)\r\n\r\n# Create DataFrame\r\nusersDataset = spark.createDataFrame(users)\r\n\r\n# Write to Cassandra\r\nusersDataset.write \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .mode(\"append\") \\\r\n    .options(table=\"users\", keyspace=\"movielens22072025\") \\\r\n    .save()\r\n\r\n# Read back from Cassandra\r\nreadUsers = spark.read \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .options(table=\"users\", keyspace=\"movielens22072025\") \\\r\n    .load()\r\n\r\nreadUsers.show()","user":"anonymous","dateUpdated":"2025-07-22T05:35:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|    143| 42|     M|technician|08832|\n|    909| 50|     F|  educator|53171|\n|    468| 28|     M|  engineer|02341|\n|    583| 44|     M|  engineer|29631|\n|    403| 37|     M|     other|06811|\n|    546| 36|     M| executive|22911|\n|    771| 26|     M|   student|15232|\n|    618| 15|     F|   student|44212|\n|    411| 34|     M|  educator|44691|\n|    471| 10|     M|   student|77459|\n|    845| 64|     M|    doctor|97405|\n|    486| 39|     M|  educator|93101|\n|    288| 34|     M| marketing|23226|\n|    652| 35|     M|     other|22911|\n|    894| 47|     M|  educator|74075|\n|    533| 43|     M| librarian|02324|\n|    834| 26|     M|     other|64153|\n|     74| 39|     M| scientist|T8H1N|\n|    359| 22|     M|   student|61801|\n|    215| 35|     M|programmer|63033|\n+-------+---+------+----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1753158849754_1578392012","id":"20250722-043409_1212169227","dateCreated":"2025-07-22T04:34:09+0000","dateStarted":"2025-07-22T05:35:07+0000","dateFinished":"2025-07-22T05:35:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9353"},{"text":"%md\n### (ii) Create Ratings RDD and DataFrame","user":"anonymous","dateUpdated":"2025-07-22T06:06:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>(ii) Create Ratings RDD and DataFrame</h3>\n"}]},"apps":[],"jobName":"paragraph_1753157069720_-2130730759","id":"20250722-040429_63853088","dateCreated":"2025-07-22T04:04:29+0000","dateStarted":"2025-07-22T06:06:41+0000","dateFinished":"2025-07-22T06:06:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9354"},{"text":"%pyspark\r\n\r\nfrom pyspark.sql import Row\r\nfrom pyspark.sql import functions as F\r\n\r\n# Parse each line into (user_id, movieid, rating)\r\ndef parseInput2(line):\r\n    fields = line.split('\\t')\r\n    return Row(user_id=int(fields[0]), movieid=int(fields[1]), rating=int(fields[2]))\r\n\r\n# Load ratings data from HDFS\r\nlines = spark.sparkContext.textFile(\"hdfs:///tmp/ml-100k/u.data\")\r\n\r\n# Map lines to Rows\r\nratings = lines.map(parseInput2)\r\n\r\n# Create DataFrame from ratings\r\nratingsDataset = spark.createDataFrame(ratings)\r\n\r\n# Write to Cassandra\r\nratingsDataset.write \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .mode(\"append\") \\\r\n    .options(table=\"ratings\", keyspace=\"movielens22072025\") \\\r\n    .save()\r\n\r\n# Read back from Cassandra\r\nreadRatings = spark.read \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .options(table=\"ratings\", keyspace=\"movielens22072025\") \\\r\n    .load()\r\n\r\n# Show the result\r\nreadRatings.show()","user":"anonymous","dateUpdated":"2025-07-22T05:38:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+------+\n|user_id|movieid|rating|\n+-------+-------+------+\n|    143|    258|     3|\n|    143|    271|     4|\n|    143|    272|     4|\n|    143|    286|     2|\n|    143|    288|     5|\n|    143|    294|     3|\n|    143|    307|     4|\n|    143|    313|     5|\n|    143|    315|     4|\n|    143|    322|     4|\n|    143|    323|     3|\n|    143|    325|     5|\n|    143|    326|     5|\n|    143|    328|     4|\n|    143|    331|     5|\n|    143|    333|     5|\n|    143|    347|     5|\n|    143|    682|     3|\n|    143|    690|     2|\n|    143|   1038|     3|\n+-------+-------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1753162649727_1808712631","id":"20250722-053729_1622770537","dateCreated":"2025-07-22T05:37:29+0000","dateStarted":"2025-07-22T05:38:02+0000","dateFinished":"2025-07-22T05:38:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9355"},{"text":"%md\n### (iii) Create Movie RDD and DataFrame\n","user":"anonymous","dateUpdated":"2025-07-22T06:06:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>(iii) Create Movie RDD and DataFrame</h3>\n"}]},"apps":[],"jobName":"paragraph_1753156598303_605930159","id":"20250722-035638_1264147619","dateCreated":"2025-07-22T03:56:38+0000","dateStarted":"2025-07-22T06:06:55+0000","dateFinished":"2025-07-22T06:06:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9356"},{"text":"%pyspark\r\n\r\nfrom pyspark.sql import Row\r\nfrom pyspark.sql import functions as F\r\n\r\n# Parse movie lines\r\ndef parse_movie(line):\r\n    fields = line.split('|')\r\n    return Row(\r\n        movieid=int(fields[0]),\r\n        title=fields[1],\r\n        unknown=int(fields[5]),\r\n        action=int(fields[6]),\r\n        adventure=int(fields[7]),\r\n        animation=int(fields[8]),\r\n        children=int(fields[9]),\r\n        comedy=int(fields[10]),\r\n        crime=int(fields[11]),\r\n        documentary=int(fields[12]),\r\n        drama=int(fields[13]),\r\n        fantasy=int(fields[14]),\r\n        filmnoir=int(fields[15]),\r\n        horror=int(fields[16]),\r\n        musical=int(fields[17]),\r\n        mystery=int(fields[18]),\r\n        romance=int(fields[19]),\r\n        scifi=int(fields[20]),\r\n        thriller=int(fields[21]),\r\n        war=int(fields[22]),\r\n        western=int(fields[23])\r\n    )\r\n\r\n# Load raw movie data from HDFS\r\nmovie_lines = spark.sparkContext.textFile(\"hdfs:///tmp/ml-100k/u.item\")\r\n\r\n# Apply parsing\r\nmovies = movie_lines.map(parse_movie)\r\n\r\n# Convert to DataFrame\r\nmovies_df = spark.createDataFrame(movies)\r\n\r\n# Write to Cassandra\r\nmovies_df.write \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .mode(\"append\") \\\r\n    .options(table=\"titles\", keyspace=\"movielens22072025\") \\\r\n    .save()\r\n\r\n# Read back from Cassandra\r\nreadMovies = spark.read \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .options(table=\"titles\", keyspace=\"movielens22072025\") \\\r\n    .load()\r\n\r\n# Show result\r\nreadMovies.show()","user":"anonymous","dateUpdated":"2025-07-22T05:39:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+--------------------+-------+---+-------+\n|movieid|action|adventure|animation|children|comedy|crime|documentary|drama|fantasy|filmnoir|horror|musical|mystery|romance|scifi|thriller|               title|unknown|war|western|\n+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+--------------------+-------+---+-------+\n|    143|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      1|      0|      0|    0|       0|Sound of Music, T...|      0|  0|      0|\n|    909|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|Dangerous Beauty ...|      0|  0|      0|\n|    468|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|         Rudy (1993)|      0|  0|      0|\n|    583|     0|        0|        0|       0|     0|    1|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|Romeo Is Bleeding...|      0|  0|      0|\n|   1189|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  Prefontaine (1997)|      0|  0|      0|\n|    403|     1|        1|        0|       0|     0|    1|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|       Batman (1989)|      0|  0|      0|\n|    546|     1|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1| Broken Arrow (1996)|      0|  0|      0|\n|   1049|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0| House Arrest (1996)|      0|  0|      0|\n|   1327|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|     Captives (1994)|      0|  0|      0|\n|    771|     1|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    1|       1|Johnny Mnemonic (...|      0|  0|      0|\n|    618|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|       Picnic (1955)|      0|  0|      0|\n|    411|     0|        0|        0|       0|     1|    0|          0|    0|      1|       0|     0|      0|      0|      1|    1|       0|Nutty Professor, ...|      0|  0|      0|\n|    471|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|Courage Under Fir...|      0|  1|      0|\n|   1125|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|Innocents, The (1...|      0|  0|      0|\n|    845|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|That Thing You Do...|      0|  0|      0|\n|    486|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      1|    0|       0|      Sabrina (1954)|      0|  0|      0|\n|   1045|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|     Fearless (1993)|      0|  0|      0|\n|    288|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     1|      0|      0|      0|    0|       1|       Scream (1996)|      0|  0|      0|\n|    652|     0|        0|        0|       0|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|Rosencrantz and G...|      0|  0|      0|\n|   1101|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      1|      0|    0|       0|Six Degrees of Se...|      0|  0|      0|\n+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+--------------------+-------+---+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1753157006466_-1085660802","id":"20250722-040326_823125590","dateCreated":"2025-07-22T04:03:26+0000","dateStarted":"2025-07-22T05:39:19+0000","dateFinished":"2025-07-22T05:39:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9357"},{"text":"%md\n\n## Question 1: Calculate the average ratings for each movie.","user":"anonymous","dateUpdated":"2025-07-22T05:40:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Question 1: Calculate the average ratings for each movie.</h2>\n"}]},"apps":[],"jobName":"paragraph_1753162759367_-1023904005","id":"20250722-053919_1474376775","dateCreated":"2025-07-22T05:39:19+0000","dateStarted":"2025-07-22T05:40:17+0000","dateFinished":"2025-07-22T05:40:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9358"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import avg\n\n# Join ratings and movie metadata on movieid\njoined_df = readRatings.join(readMovies, on=\"movieid\")\n\n# Group by title and compute average rating\navg_ratings_df = joined_df.groupBy(\"title\").agg(avg(\"rating\").alias(\"avg_rating\"))\n\n# Order by average rating descending and get top 20\ntop_20_movies = avg_ratings_df.orderBy(\"avg_rating\", ascending=False).limit(20)\n\n# Show the result\ntop_20_movies.show()\n","user":"anonymous","dateUpdated":"2025-07-22T05:42:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----------------+\n|               title|       avg_rating|\n+--------------------+-----------------+\n|Entertaining Ange...|              5.0|\n|Someone Else's Am...|              5.0|\n|Great Day in Harl...|              5.0|\n|They Made Me a Cr...|              5.0|\n|Aiqing wansui (1994)|              5.0|\n|Marlene Dietrich:...|              5.0|\n|Saint of Fort Was...|              5.0|\n|     Star Kid (1997)|              5.0|\n|Santa with Muscle...|              5.0|\n|  Prefontaine (1997)|              5.0|\n|Pather Panchali (...|            4.625|\n|         Anna (1996)|              4.5|\n|      Everest (1998)|              4.5|\n|Some Mother's Son...|              4.5|\n|Maya Lin: A Stron...|              4.5|\n|Close Shave, A (1...|4.491071428571429|\n|Schindler's List ...|4.466442953020135|\n|Wrong Trousers, T...|4.466101694915254|\n|   Casablanca (1942)| 4.45679012345679|\n|Wallace & Gromit:...|4.447761194029851|\n+--------------------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1753162817089_1327589327","id":"20250722-054017_1240725596","dateCreated":"2025-07-22T05:40:17+0000","dateStarted":"2025-07-22T05:42:58+0000","dateFinished":"2025-07-22T05:43:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9359"},{"text":"%md\n\n## Question 2: Identify the top ten movies with the highest average ratings.","user":"anonymous","dateUpdated":"2025-07-22T05:41:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Question 2: Identify the top ten movies with the highest average ratings.</h2>\n"}]},"apps":[],"jobName":"paragraph_1753162836142_-464925150","id":"20250722-054036_1609716196","dateCreated":"2025-07-22T05:40:36+0000","dateStarted":"2025-07-22T05:41:42+0000","dateFinished":"2025-07-22T05:41:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9360"},{"text":"%pyspark\n\ntop_20_movies.limit(10).show()\n","user":"anonymous","dateUpdated":"2025-07-22T05:43:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+\n|               title|avg_rating|\n+--------------------+----------+\n|Aiqing wansui (1994)|       5.0|\n|Marlene Dietrich:...|       5.0|\n|Santa with Muscle...|       5.0|\n|Great Day in Harl...|       5.0|\n|Entertaining Ange...|       5.0|\n|They Made Me a Cr...|       5.0|\n|Saint of Fort Was...|       5.0|\n|Someone Else's Am...|       5.0|\n|     Star Kid (1997)|       5.0|\n|  Prefontaine (1997)|       5.0|\n+--------------------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1753162901688_-1012899529","id":"20250722-054141_1307535554","dateCreated":"2025-07-22T05:41:41+0000","dateStarted":"2025-07-22T05:43:20+0000","dateFinished":"2025-07-22T05:43:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9361"},{"text":"%md\n\n## Question 3: Find the users who have rate at least 50 movies and identify their favourite movie genres","user":"anonymous","dateUpdated":"2025-07-22T05:45:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163000144_2079063581","id":"20250722-054320_537611397","dateCreated":"2025-07-22T05:43:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9362","dateFinished":"2025-07-22T05:45:05+0000","dateStarted":"2025-07-22T05:45:05+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Question 3: Find the users who have rate at least 50 movies and identify their favourite movie genres</h2>\n"}]}},{"text":"%pyspark\n\nfrom pyspark.sql.functions import col, count, row_number\nfrom pyspark.sql.window import Window\n\n# Filter users who rated at least 50 movies\nfiltered_users = readRatings.groupBy(\"user_id\") \\\n    .agg(count(\"*\").alias(\"num_ratings\")) \\\n    .filter(col(\"num_ratings\") >= 50) \\\n    .select(\"user_id\")\n\n# Join ratings with filtered users and titles\nfiltered_ratings = readRatings \\\n    .join(filtered_users, on=\"user_id\") \\\n    .join(readMovies, on=\"movieid\")\n\n# Unpivot genre columns\ngenre_columns = [\n    \"unknown\", \"action\", \"adventure\", \"animation\", \"children\", \"comedy\", \"crime\",\n    \"documentary\", \"drama\", \"fantasy\", \"filmNoir\", \"horror\", \"musical\", \"mystery\",\n    \"romance\", \"sciFi\", \"thriller\", \"war\", \"western\"\n]\n\n# Flatten genres (manual unpivot via union)\nuser_genres = None\nfor genre in genre_columns:\n    temp = filtered_ratings.filter(col(genre) == 1) \\\n        .select(\"user_id\").withColumn(\"genre\", F.lit(genre))\n    user_genres = temp if user_genres is None else user_genres.union(temp)\n\n# Count genre frequencies per user\nuser_genre_counts = user_genres.groupBy(\"user_id\", \"genre\") \\\n    .agg(count(\"*\").alias(\"count\"))\n\n# Rank genres per user\nwindowSpec = Window.partitionBy(\"user_id\").orderBy(col(\"count\").desc())\n\nranked_genres = user_genre_counts.withColumn(\"rank\", row_number().over(windowSpec))\n\n# Select top genre per user\ntop_genres_per_user = ranked_genres.filter(col(\"rank\") == 1) \\\n    .orderBy(col(\"count\").desc())\n\ntop_genres_per_user.select(\"user_id\", \"genre\", \"count\").show()\n","user":"anonymous","dateUpdated":"2025-07-22T05:45:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163105577_655662861","id":"20250722-054505_1831420936","dateCreated":"2025-07-22T05:45:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10987","dateFinished":"2025-07-22T05:46:39+0000","dateStarted":"2025-07-22T05:45:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-----+\n|user_id| genre|count|\n+-------+------+-----+\n|    655| drama|  410|\n|    405| drama|  309|\n|    537| drama|  251|\n|    450| drama|  237|\n|     13| drama|  218|\n|    234| drama|  213|\n|    416| drama|  212|\n|    279|comedy|  211|\n|    201| drama|  196|\n|    393|comedy|  191|\n|    181| drama|  188|\n|    303|comedy|  184|\n|    334| drama|  174|\n|     90| drama|  173|\n|    378| drama|  170|\n|    276| drama|  168|\n|    429| drama|  167|\n|    474| drama|  166|\n|    293| drama|  165|\n|    308| drama|  163|\n+-------+------+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%md\n\n## Question 4: Find all the users who are less than 20 years old","user":"anonymous","dateUpdated":"2025-07-22T05:47:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163132499_280178583","id":"20250722-054532_1375520595","dateCreated":"2025-07-22T05:45:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11064","dateFinished":"2025-07-22T05:47:39+0000","dateStarted":"2025-07-22T05:47:39+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Question 4: Find all the users who are less than 20 years old</h2>\n"}]}},{"text":"%pyspark\n\nuser_less_than_20_yo = readUsers.filter(\"age < 20\")\n\nuser_less_than_20_yo.show()","user":"anonymous","dateUpdated":"2025-07-22T05:49:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163258736_227219508","id":"20250722-054738_1346707599","dateCreated":"2025-07-22T05:47:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11151","dateFinished":"2025-07-22T05:49:08+0000","dateStarted":"2025-07-22T05:49:08+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|    618| 15|     F|   student|44212|\n|    471| 10|     M|   student|77459|\n|    580| 16|     M|   student|17961|\n|    262| 19|     F|   student|78264|\n|    880| 13|     M|   student|83702|\n|    632| 18|     M|   student|55454|\n|    541| 19|     F|   student|84302|\n|    453| 18|     M|   student|06333|\n|    223| 19|     F|   student|47906|\n|    462| 19|     F|   student|02918|\n|    550| 16|     F|   student|95453|\n|    289| 11|     M|      none|94619|\n|    142| 13|     M|     other|48118|\n|    482| 18|     F|   student|40256|\n|    303| 19|     M|   student|14853|\n|    101| 15|     M|   student|05146|\n|    872| 19|     F|   student|74078|\n|    601| 19|     F|    artist|99687|\n|    817| 19|     M|   student|60152|\n|    710| 19|     M|   student|92020|\n+-------+---+------+----------+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%md\n\n## Question 5: Find all the users whose occupation is 'scientist' and whose age is between 30 and 40 years old.","user":"anonymous","dateUpdated":"2025-07-22T05:50:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163293337_-731898203","id":"20250722-054813_1055881241","dateCreated":"2025-07-22T05:48:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11233","dateFinished":"2025-07-22T05:50:50+0000","dateStarted":"2025-07-22T05:50:50+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Question 5: Find all the users whose occupation is 'scientist' and whose age is between 30 and 40 years old.</h2>\n"}]}},{"text":"%pyspark\n\nscientist_between_30_40_yo = readUsers.filter(\n    (col(\"age\") > 30) & (col(\"age\") < 40) & (col(\"occupation\") == \"scientist\"))\n    \nscientist_between_30_40_yo.show()","user":"anonymous","dateUpdated":"2025-07-22T05:52:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163450698_1482394658","id":"20250722-055050_1133258571","dateCreated":"2025-07-22T05:50:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11359","dateFinished":"2025-07-22T05:52:20+0000","dateStarted":"2025-07-22T05:52:19+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|     74| 39|     M| scientist|T8H1N|\n|    183| 33|     M| scientist|27708|\n|    107| 39|     M| scientist|60466|\n|    272| 33|     M| scientist|53706|\n|    430| 38|     M| scientist|98199|\n|    643| 39|     M| scientist|55122|\n|    543| 33|     M| scientist|95123|\n|    730| 31|     F| scientist|32114|\n|    337| 37|     M| scientist|10522|\n|    554| 32|     M| scientist|62901|\n|     40| 38|     M| scientist|27514|\n|     71| 39|     M| scientist|98034|\n|    874| 36|     M| scientist|37076|\n|    538| 31|     M| scientist|21010|\n+-------+---+------+----------+-----+\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-07-22T05:52:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1753163539378_-1285017692","id":"20250722-055219_359038228","dateCreated":"2025-07-22T05:52:19+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11430","errorMessage":""}],"name":"STQD6324_Assignment3_P153125","id":"2M1V3G23Y","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}